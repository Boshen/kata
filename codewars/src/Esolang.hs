import Test.Hspec

import Data.Char

interpret :: Int -> String -> String
interpret 256 code = interpret 0 code
interpret n ('.':xs) = [chr n] ++ (interpret n xs)
interpret n ('+':xs) = interpret (n + 1) xs
interpret n (x:xs) = [x] ++ (interpret n xs)
interpret n _ = ""

myFirstInterpreter :: String -> String
myFirstInterpreter = interpret 0

main = hspec $ do
  describe "Example Tests" $ do
    it "passes non-alphabet" $ do
      myFirstInterpreter "ABCDEFGHIJKLMNOPQRSTUVWXYZ" `shouldBe` "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    it "passes alphabet" $ do
      myFirstInterpreter "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+.+." `shouldBe` "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    it "passes hello world" $ do
      myFirstInterpreter "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++.+++++++++++++++++++++++++++++.+++++++..+++.+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++.++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++.+++++++++++++++++++++++++++++++++++++++++++++++++++++++.++++++++++++++++++++++++.+++.++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++.++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++.+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++." `shouldBe` "Hello, World!"

